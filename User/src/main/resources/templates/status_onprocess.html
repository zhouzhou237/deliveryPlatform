<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="Askbootstrap" />
  <meta name="author" content="Askbootstrap" />
  <title>Happy Meal</title><!-- Slick Slider -->
  <link rel="stylesheet" type="text/css" href="/css/slick.min.css" />
  <link rel="stylesheet" type="text/css" href="/css/slick-theme.min.css" /><!-- Feather Icon-->
  <link href="/css/feather.css" rel="stylesheet" type="text/css" /><!-- Bootstrap core CSS -->
  <link href="/css/bootstrap.min.css" rel="stylesheet" /><!-- Custom styles for this template -->
  <link href="/css/style.css" rel="stylesheet" /><!-- Sidebar CSS -->
  <link href="/css/demo.css" rel="stylesheet" />
</head>
<body class="fixed-bottom-bar">
<header class="section-header">
  <section class="header-main shadow-sm bg-white">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-1">
          <a href="/index" class="brand-wrap mb-0"><img alt="#" class="img-fluid" src="/picture/logo_web.png" /></a><!-- brand-wrap.// -->
        </div>
        <div class="col-3 d-flex align-items-center m-none">
          <div class="dropdown mr-3">
            <a class="text-dark dropdown-toggle d-flex align-items-center py-3" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <div>
                <i class="feather-map-pin mr-2 bg-light rounded-pill p-2 icofont-size"></i>
              </div>
              <div>
                <p class="text-muted mb-0 small">Select Location</p>Jawaddi Ludhiana...
              </div></a>
            <div class="dropdown-menu p-0 drop-loc" aria-labelledby="navbarDropdown">
              <div class="osahan-country">
                <div class="search_location bg-primary p-3 text-right">
                  <div class="input-group rounded shadow-sm overflow-hidden">
                    <div class="input-group-prepend">
                      <button class="border-0 btn btn-outline-secondary text-dark bg-white btn-block"><i class="feather-search"></i></button>
                    </div><input type="text" class="shadow-none border-0 form-control" placeholder="Enter Your Location" />
                  </div>
                </div>
                <div class="p-3 border-bottom">
                  <a href="/index" class="text-decoration-none">
                    <p class="font-weight-bold text-primary m-0"><i class="feather-navigation"></i>New York,USA</p></a>
                </div>
                <div class="filter">
                  <h6 class="px-3 py-3 bg-light pb-1 m-0 border-bottom">Choose your country</h6>
                  <div class="custom-control border-bottom px-0 custom-radio">
                    <input type="radio" id="customRadio1" name="location" class="custom-control-input" /><label class="custom-control-label py-3 w-100 px-3" for="customRadio1">Afghanistan</label>
                  </div>
                  <div class="custom-control border-bottom px-0 custom-radio">
                    <input type="radio" id="customRadio2" name="location" class="custom-control-input" checked="checked" /><label class="custom-control-label py-3 w-100 px-3" for="customRadio2">India</label>
                  </div>
                  <div class="custom-control border-bottom px-0 custom-radio">
                    <input type="radio" id="customRadio3" name="location" class="custom-control-input" /><label class="custom-control-label py-3 w-100 px-3" for="customRadio3">USA</label>
                  </div>
                  <div class="custom-control border-bottom px-0 custom-radio">
                    <input type="radio" id="customRadio4" name="location" class="custom-control-input" /><label class="custom-control-label py-3 w-100 px-3" for="customRadio4">Australia</label>
                  </div>
                  <div class="custom-control border-bottom px-0 custom-radio">
                    <input type="radio" id="customRadio5" name="location" class="custom-control-input" /><label class="custom-control-label py-3 w-100 px-3" for="customRadio5">Japan</label>
                  </div>
                  <div class="custom-control px-0 custom-radio">
                    <input type="radio" id="customRadio6" name="location" class="custom-control-input" /><label class="custom-control-label py-3 w-100 px-3" for="customRadio6">China</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div><!-- col.// -->
        <div class="col-8">
          <div class="d-flex align-items-center justify-content-end pr-5">
            <!-- search --><a href="/search" class="widget-header mr-4 text-dark">
            <div class="icon d-flex align-items-center">
              <i class="feather-search h6 mr-2 mb-0"></i><span>Search</span>
            </div></a><!-- offers --><a href="/offers" class="widget-header mr-4 text-white btn bg-primary m-none">
            <div class="icon d-flex align-items-center">
              <i class="feather-disc h6 mr-2 mb-0"></i><span>Offers</span>
            </div></a><!-- signin --><a href="/login" class="widget-header mr-4 text-dark m-none">
            <div class="icon d-flex align-items-center">
              <i class="feather-user h6 mr-2 mb-0"></i><span>Sign in</span>
            </div></a><!-- my account -->
            <div class="dropdown mr-4 m-none">
              <a href="#" class="dropdown-toggle text-dark py-3 d-block" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img alt="#" src="/picture/1.jpg" class="img-fluid rounded-circle header-user mr-2 header-user" id="userImage"/>
                Hi <span id="username">User</span>
              </a>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="/profile">My account</a>
                <a class="dropdown-item" href="/faq">Delivery support</a>
                <a class="dropdown-item" href="/contact_us">Contant us</a>
                <a class="dropdown-item" href="/terms">Term of use</a>
                <a class="dropdown-item" href="/privacy">Privacy policy</a>
                <a class="dropdown-item" href="/login">Logout</a>
              </div>
            </div><!-- signin --><a href="/checkout" class="widget-header mr-4 text-dark">
            <div class="icon d-flex align-items-center">
              <i class="feather-shopping-cart h6 mr-2 mb-0"></i><span>Cart</span>
            </div></a><a class="toggle" href="#"><span></span></a>
          </div><!-- widgets-wrap.// -->
        </div><!-- col.// -->
      </div><!-- row.// -->
    </div><!-- container.// -->
  </section><!-- header-main .// -->
</header>
<div class="d-none">
  <div class="bg-primary p-3 d-flex align-items-center">
    <a class="toggle togglew toggle-2" href="#"><span></span></a>
    <h4 class="font-weight-bold m-0 text-white">My Order</h4>
  </div>
</div>
<section class="py-4 osahan-main-body">
  <div class="container">
    <div class="row">
      <div class="col-md-3">
        <ul class="nav nav-tabsa custom-tabsa border-0 flex-column bg-white rounded overflow-hidden shadow-sm p-2 c-t-order" id="myTab" role="tablist">
          <li class="nav-item" role="presentation">
            <a class="nav-link border-0 text-dark py-3 active" href="/my_order"><i class="feather-check mr-2 text-success mb-0"></i>Completed</a>
          </li>
          <li class="nav-item border-top" role="presentation">
            <a class="nav-link border-0 text-dark py-3" href="/my_order"><i class="feather-clock mr-2 text-warning mb-0"></i>On Progress</a>
          </li>
          <li class="nav-item border-top" role="presentation">
            <a class="nav-link border-0 text-dark py-3" href="/my_order"><i class="feather-x-circle mr-2 text-danger mb-0"></i>Canceled</a>
          </li>
        </ul>
      </div>
      <div class="col-md-9">
        <!-- body -->
        <section class="bg-white osahan-main-body rounded shadow-sm overflow-hidden">
          <div class="container p-0">
            <div class="row">
              <div class="col-lg-12">
                <div class="osahan-status" id="order-status-container">
                  <!-- 动态订单状态将插入在这里 -->
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</section><!-- footer -->
<footer class="section-footer border-top bg-dark">
  <div class="container">
    <section class="footer-top padding-y py-5">
      <div class="row pt-3">
        <aside class="col-md-4 footer-about">
          <article class="d-flex pb-3">
            <div><img alt="#" src="/picture/logo_web.png" class="logo-footer mr-3" /></div>
            <div>
              <h6 class="title text-white">About Us</h6>
              <p class="text-muted">Changing the dining model, giving you a happy meal. We strive to bring the best of culinary delights right to your doorstep, making every dining experience a seamless and enjoyable one. Whether it’s a cozy dinner at home or a bustling office lunch, we ensure that satisfaction and taste are just an order away.</p>
              <div class="d-flex align-items-center">
                <a class="btn btn-icon btn-outline-light mr-1 btn-sm" title="Facebook" target="_blank" href="#"><i class="feather-facebook"></i></a><a class="btn btn-icon btn-outline-light mr-1 btn-sm" title="Instagram" target="_blank" href="#"><i class="feather-instagram"></i></a><a class="btn btn-icon btn-outline-light mr-1 btn-sm" title="Youtube" target="_blank" href="#"><i class="feather-youtube"></i></a><a class="btn btn-icon btn-outline-light mr-1 btn-sm" title="Twitter" target="_blank" href="#"><i class="feather-twitter"></i></a>
              </div>
            </div>
          </article>
        </aside>
        <aside class="col-sm-3 col-md-2 text-white">
          <h6 class="title">Error Pages</h6>
          <ul class="list-unstyled hov_footer">
            <li>
              <a href="/not_found" class="text-muted">Not found</a>
            </li>
            <li>
              <a href="/maintence" class="text-muted">Maintence</a>
            </li>
            <li>
              <a href="/coming_soon" class="text-muted">Coming Soon</a>
            </li>
          </ul>
        </aside>
        <aside class="col-sm-3 col-md-2 text-white">
          <h6 class="title">Services</h6>
          <ul class="list-unstyled hov_footer">
            <li>
              <a href="/faq" class="text-muted">Delivery Support</a>
            </li>
            <li>
              <a href="/contact_us" class="text-muted">Contact Us</a>
            </li>
            <li>
              <a href="/terms" class="text-muted">Terms of use</a>
            </li>
            <li>
              <a href="/privacy" class="text-muted">Privacy policy</a>
            </li>
          </ul>
        </aside>
        <aside class="col-sm-3 col-md-2 text-white">
          <h6 class="title">For users</h6>
          <ul class="list-unstyled hov_footer">
            <li>
              <a href="/login" class="text-muted">User Login</a>
            </li>
            <li>
              <a href="/signup" class="text-muted">User register</a>
            </li>
            <li>
              <a href="/forgot_password" class="text-muted">Forgot Password</a>
            </li>
            <li>
              <a href="/profile" class="text-muted">Account Setting</a>
            </li>
          </ul>
        </aside>
        <aside class="col-sm-3 col-md-2 text-white">
          <h6 class="title">More Pages</h6>
          <ul class="list-unstyled hov_footer">
            <li>
              <a href="/trending" class="text-muted">Trending</a>
            </li>
            <li>
              <a href="/most_popular" class="text-muted">Most popular</a>
            </li>
            <li>
              <a href="/restaurant" class="text-muted">Restaurant Details</a>
            </li>
            <li>
              <a href="/favorites" class="text-muted">Favorites</a>
            </li>
          </ul>
        </aside>
      </div><!-- row.// -->
    </section>
  </div>
</footer>


<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.bundle.min.js"></script><!-- slick Slider JS-->
<script type="text/javascript" src="/js/slick.min.js"></script><!-- Sidebar JS-->
<script type="text/javascript" src="/js/hc-offcanvas-nav.js"></script><!-- Custom scripts for all pages-->
<script type="text/javascript" src="/js/osahan.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    axios.get('/api/users/me')
            .then(response => {
              const user = response.data;
              document.getElementById('username').textContent = user.uname;

              // 获取订单数据并动态渲染
              axios.get(`/api/orders/user/${user.id}`)
                      .then(response => {
                        const orders = response.data;
                        const orderStatusContainer = document.getElementById('order-status-container');
                        orders.forEach(order => {
                          const orderHtml = `
                  <div class="osahan-status">
                    <div class="p-3 status-order border-bottom bg-white">
                      <p class="small m-0"><i class="feather-calendar text-primary"></i>${new Date(order.orderDate).toLocaleString()}</p>
                    </div>
                    <div class="p-3 border-bottom">
                      <div class="d-flex">
                        <h6 class="font-weight-bold">Order Status</h6><span class="ml-auto"><a href="/map" class="btn btn-primary">Track on map</a></span>
                      </div>
                      <div class="tracking-wrap">
                        <div class="my-1 step ${order.status === 'Preparing' ? 'active' : ''}">
                          <span class="icon text-success"><i class="feather-check-circle"></i></span><span class="text small">Preparing order</span>
                        </div>
                        <div class="my-1 step ${order.status === 'Ready' ? 'active' : ''}">
                          <span class="icon text-danger"><i class="feather-x-circle"></i></span><span class="text small">Ready to collect</span>
                        </div>
                        <div class="my-1 step ${order.status === 'On the way' ? 'active' : ''}">
                          <span class="icon text-danger"><i class="feather-x-circle"></i></span><span class="text small">On the way</span>
                        </div>
                        <div class="my-1 step ${order.status === 'Delivered' ? 'active' : ''}">
                          <span class="icon text-danger"><i class="feather-x-circle"></i></span><span class="text small">Delivered Order</span>
                        </div>
                      </div>
                    </div>
                    <div class="p-3 border-bottom bg-white">
                      <h6 class="font-weight-bold">Destination</h6>
                      <p class="m-0 small">${order.destination}</p>
                    </div>
                    <div class="p-3 border-bottom">
                      <p class="font-weight-bold small mb-1">Courier</p><img alt="#" src="/picture/logo_web.png" class="img-fluid sc-osahan-logo mr-2" /><span class="small text-primary font-weight-bold">Happy meal Courier</span>
                    </div>
                    <div class="p-3 border-bottom bg-white">
                      <div class="d-flex align-items-center mb-2">
                        <h6 class="font-weight-bold mb-1">Total Cost</h6>
                        <h6 class="font-weight-bold ml-auto mb-1">$${order.totalAmount.toFixed(2)}</h6>
                      </div>
                      <p class="m-0 small text-muted">You can check your order detail here,<br />
                      Thank you for order.</p>
                    </div>
                  </div>
                `;
                          orderStatusContainer.innerHTML += orderHtml;
                        });
                      })
                      .catch(error => {
                        console.error('Error fetching orders:', error);
                      });
            })
            .catch(error => {
              console.error('Error fetching user data:', error);
              window.location.href = '/login';
            });
  });
</script>
</body>
</html>
